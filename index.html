<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø£Ø¯Ø§Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ (Ø·Ù„Ø¨ Ù†Ù‚Ù„- Ø¨Ø­Ø« Ø¹Ù† ÙƒÙˆØ¯)</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #f8f9fa;
            --text-color: #333;
            --border-color: #dee2e6;
            --hover-color: #004494;
            --success-color: #28a745;
        }
        body {
            font-family: 'Tahoma', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%;
            border-top: 5px solid var(--primary-color);
        }
        h1, h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }
        p, li {
            line-height: 1.8;
            font-size: 16px;
        }
        .instructions {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--primary-color);
        }
        .bookmarklet-link {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
            cursor: move;
            transition: background-color 0.3s, transform 0.2s;
            text-align: center;
        }
        .bookmarklet-link:hover {
            background-color: var(--hover-color);
            transform: scale(1.05);
        }
        .code-container {
            position: relative;
        }
        textarea {
            width: 100%;
            height: 200px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: monospace;
            font-size: 14px;
            direction: ltr;
            resize: vertical;
        }
        .copy-button {
            position: absolute;
            top: 10px;
            left: 10px; 
            padding: 8px 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .copy-button:hover {
            background-color: var(--hover-color);
        }
        .copy-button.copied {
            background-color: var(--success-color);
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Ø£Ø¯Ø§Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ (Ø·Ù„Ø¨ Ù†Ù‚Ù„- Ø¨Ø­Ø« Ø¹Ù† ÙƒÙˆØ¯)</h1>
            <p> Ù…Ø¹ ØªØ­ÙŠØ§Øª Ø§Ø³ØªØ§Ø°/ Ù…Ø­Ù…ÙˆØ¯ Ø¹Ø§Ø¯Ù„ ØµØ§Ù„Ø­ </p>
        </header>

        <main>
            <section id="bookmarklet">
                <h2> Ù‡ÙŠØ§ : Ø§Ø³ØªØ¹Ø¯  Ù„ØªÙ„Ù‚ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ø§Ù…ÙŠØ° Ù…Ø¯Ø±Ø³ØªÙƒ ØµÙØ§ ØµÙØ§  (Bookmarklet)</h2>
                <div class="instructions">
                    <p><strong>Ù„Ø§ ØªÙ†Ø³Ù‰ :</strong> Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø§Ù„Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ© (Bookmarks Bar).</p>
                    <div style="text-align: center; margin: 20px 0;">
                        <a class="bookmarklet-link" href="javascript:(async function(){const s='.paginate_button.next:not(.disabled)';let d=[];function f1(){const t=document.querySelector('table');if(!t)return;const n=t.querySelectorAll('tr');if(d.length===0){const t=Array.from(n[0].querySelectorAll('th')).map(t=>t.innerText.trim());d.push(t)}for(let t=1;t<n.length;t++){const e=Array.from(n[t].querySelectorAll('td')).map(t=>t.innerText.trim());e.length>0&&d.push(e)}}function f2(t){const e='\uFEFF';let n=t.map(t=>t.map(t=>`%22${String(t).split('%22').join('%22%22')}%22`).join(',')).join('\n');const o=new Blob([e+n],{type:'text/csv;charset=utf-8;'});const r=document.createElement('a'),a=URL.createObjectURL(o);r.setAttribute('href',a),r.setAttribute('download','student_data.csv'),r.style.visibility='hidden',document.body.appendChild(r),r.click(),document.body.removeChild(r)}async function f3(){for(;;){f1();const t=document.querySelector(s);if(t){t.click();await new Promise(t=>setTimeout(t,2e3))}else break}f2(d)}f3()})();">ğŸ“Š Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ù†Ø³Ø®Ø© Ù†Ù‡Ø§Ø¦ÙŠØ©)</a>
                    </div>
                     <p><strong>ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong></p>
                    <ol>
                        <li> Ø§Ø°Ù‡Ø¨ Ø§Ù„Ù‰ ØµÙØ­Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ„Ù…ÙŠØ°-ØªØ¨ÙˆÙŠØ¨ Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ-ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ù†Ù‚Ù„ -Ø¨Ø­Ø« Ø¹Ù† ÙƒÙˆØ¯-Ø§Ø®ØªØ± ØµÙ   </li>
                        <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "ğŸ“Š Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª " Ø§Ù„Ø°ÙŠ ÙˆØ¶Ø¹ØªÙ‡ ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª.</li>
                        <li>Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.</li>
                    </ol>
                </div>
            </section>

            <section id="manual">
                <h2>2. Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©: Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</h2>
                <p>Ø¥Ø°Ø§ Ù„Ù… ØªØ¹Ù…Ù„ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ØŒ ÙÙ‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¶Ù…ÙˆÙ†Ø©. Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ù‡Ù†Ø§ ÙˆØ§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„.</p>
                <div class="code-container">
                    <button id="copyBtn" class="copy-button" onclick="copyCode()">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
                    <textarea id="scraperCode" readonly>
(async function main() {
    console.log("Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...");
    const nextButtonSelector = '.paginate_button.next:not(.disabled)';
    let allData = [];

    function scrapeCurrentPage() {
        const table = document.querySelector('table');
        if (!table) { console.error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ ÙÙŠ Ø§Ù„ØµÙØ­Ø©."); return; }
        const rows = table.querySelectorAll('tr');
        if (allData.length === 0) {
            const headers = Array.from(rows[0].querySelectorAll('th')).map(h => h.innerText.trim());
            allData.push(headers);
        }
        for (let i = 1; i < rows.length; i++) {
            const cells = Array.from(rows[i].querySelectorAll('td')).map(c => c.innerText.trim());
            if(cells.length > 0) allData.push(cells);
        }
        console.log(`ØªÙ… Ø¬Ù„Ø¨ ${allData.length - 1} Ø³Ø¬Ù„ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.`);
    }

    function downloadCSV(data) {
        if (data.length <= 1) { console.log("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªÙ†Ø²ÙŠÙ„Ù‡Ø§."); return; }
        const bom = "\uFEFF";
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… split().join() Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† replace() Ù„ØªØ¬Ù†Ø¨ Ø£Ø®Ø·Ø§Ø¡ Regular Expression
        let csvContent = data.map(row =>
            row.map(cell => `"${String(cell).split('"').join('""')}"`).join(',')
        ).join('\n');
        
        const blob = new Blob([bom + csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        link.setAttribute("href", url);
        link.setAttribute("download", "student_data.csv");
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        console.log('Ø¬Ø§Ø±ÙŠ ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ (CSV)...');
        link.click();
        document.body.removeChild(link);
    }
    
    // Main loop
    while (true) {
        scrapeCurrentPage();
        const nextButton = document.querySelector(nextButtonSelector);
        if (nextButton) {
            console.log('Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©...');
            nextButton.click();
            await new Promise(resolve => setTimeout(resolve, 2000));
        } else {
            console.log('ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¢Ø®Ø± ØµÙØ­Ø©.');
            break;
        }
    }

    console.log(`Ø§ÙƒØªÙ…Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: ${allData.length - 1}`);
    downloadCSV(allData);
})();
                    </textarea>
                </div>
            </section>
        </main>
        
    </div>

    <script>
        function copyCode() {
            const textarea = document.getElementById('scraperCode');
            navigator.clipboard.writeText(textarea.value).then(() => {
                const btn = document.getElementById('copyBtn');
                btn.textContent = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>

</body>
</html>
