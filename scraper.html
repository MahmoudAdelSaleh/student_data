<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أداة استخراج بيانات الطلاب (طلب نقل- بحث عن كود)</title>
    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #f8f9fa;
            --text-color: #333;
            --border-color: #dee2e6;
            --hover-color: #004494;
            --success-color: #28a745;
        }
        body {
            font-family: 'Tahoma', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 100%;
            border-top: 5px solid var(--primary-color);
        }
        h1, h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }
        p, li {
            line-height: 1.8;
            font-size: 16px;
        }
        .instructions {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid var(--primary-color);
        }
        .bookmarklet-link {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 18px;
            font-weight: bold;
            cursor: move;
            transition: background-color 0.3s, transform 0.2s;
            text-align: center;
        }
        .bookmarklet-link:hover {
            background-color: var(--hover-color);
            transform: scale(1.05);
        }
        .code-container {
            position: relative;
        }
        textarea {
            width: 100%;
            height: 200px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: monospace;
            font-size: 14px;
            direction: ltr;
            resize: vertical;
        }
        .copy-button {
            position: absolute;
            top: 10px;
            left: 10px; 
            padding: 8px 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .copy-button:hover {
            background-color: var(--hover-color);
        }
        .copy-button.copied {
            background-color: var(--success-color);
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>أداة استخراج بيانات الطلاب (طلب نقل- بحث عن كود)</h1>
            <h2> مع تحيات استاذ/ محمود عادل صالح </h2>
        </header>

        <main>
            <section id="bookmarklet">
                <h2> هيا : استعد  لتلقي بيانات تلاميذ مدرستك صفا صفا  (Bookmarklet)</h2>
                <div class="instructions">
                    <p><strong>لا تنسى :</strong> اسحب وأفلت الزر التالي في شريط الإشارات المرجعية (Bookmarks Bar).</p>
                    <div style="text-align: center; margin: 20px 0;">
                        <a class="bookmarklet-link" href="javascript:(async function(){var _0x5b3b2b={_0x1a879e:function(_0x1b4129,_0x1b06c8){return _0x1b4129+_0x1b06c8;},_0x4b7b20:function(_0x223788,_0x1116c9){return _0x223788+_0x1116c9;},_0x247481:'text/csv;charset=utf-8;',_0x42f78d:function(_0x2d1748,_0x409559){return _0x2d1748(_0x409559);},_0x17316a:function(_0x140e6c,_0x24e0f0){return _0x140e6c(_0x24e0f0);},_0x546688:function(_0x1604a8,_0x41e126){return _0x1604a8,_0x41e126;},_0x2c10c1:function(_0x2c0691,_0x228bc7){return _0x2c0691,_0x228bc7;}};const s='.paginate_button.next:not(.disabled)';let d=[];function f1(){const _0x53b49e=document['querySelector']('table');if(!_0x53b49e)return;const _0x2117a3=_0x53b49e['querySelectorAll']('tr');if(d['length']===0){const _0x1f114c=Array['from'](_0x2117a3[0]['querySelectorAll']('th'))['map'](_0x1af7e7=>_0x1af7e7['innerText']['trim']());d['push'](_0x1f114c);}for(let _0x4c278c=1;_0x4c278c<_0x2117a3['length'];_0x4c278c++){const _0x412d0c=Array['from'](_0x2117a3[_0x4c278c]['querySelectorAll']('td'))['map'](_0x327a1e=>_0x327a1e['innerText']['trim']());_0x412d0c['length']>0&&d['push'](_0x412d0c);}}function f2(_0x546c77){const _0x298492='﻿';let _0x45a278=_0x546c77['map'](_0x4a4dc1=>_0x4a4dc1['map'](_0x19a057=>_0x5b3b2b['_0x1a879e'](_0x5b3b2b['_0x4b7b20']('"',String(_0x19a057)['split']('"')['join']('""')),'"'))['join'](','))['join']('\x0a');const _0x4879b2=new Blob([_0x5b3b2b['_0x4b7b20'](_0x298492,_0x45a278)],{'type':_0x5b3b2b['_0x247481']}),_0x36b04f=document['createElement']('a'),_0x1f7442=URL['createObjectURL'](_0x4879b2);_0x36b04f['setAttribute']('href',_0x1f7442),_0x36b04f['setAttribute']('download','student_data.csv'),_0x36b04f['style']['visibility']='hidden',document['body']['appendChild'](_0x36b04f),_0x36b04f['click'](),document['body']['removeChild'](_0x36b04f);}async function f3(){for(;;){_0x5b3b2b['_0x42f78d'](f1);const _0x3b185f=document['querySelector'](s);if(_0x3b185f){_0x3b185f['click']();await new Promise(_0x2ff25d=>_0x5b3b2b['\x31\x37\x33\x31\x36\x61'](setTimeout,_0x2ff25d,2000));}else break;}_0x5b3b2b['\x35\x34\x36\x36\x38\x38'](f2,d);}_0x5b3b2b['\x32\x63\x31\x30\x63\x31'](f3)();})();">📊 استخراج البيانات</a>
                    </div>
                     <p><strong>كيفية الاستخدام:</strong></p>
                     <ol>
                         <li> اذهب الى صفحة بيانات التلميذ-تبويب نقل الملف الإلكتروني-تسجيل طلب نقل -بحث عن كود-اختر صف   </li>
                         <li>اضغط على زر "📊 استخراج البيانات " الذي وضعته في شريط الإشارات.</li>
                         <li>انتظر حتى يتم تحميل الملف تلقائياً.</li>
                     </ol>
                </div>
            </section>

            <section id="manual">
                <h2>2. الطريقة اليدوية: نسخ الكود</h2>
                <p>إذا لم تعمل الطريقة الأولى، فهذه الطريقة مضمونة. انسخ الكود من هنا والصقه في الكونسول.</p>
                <div class="code-container">
                    <button id="copyBtn" class="copy-button" onclick="copyCode()">نسخ الكود</button>
                    <textarea id="scraperCode" readonly>
var _0x53a9=['\x6c\x6f\x67','\x62\x64\x7d\x20\u0639\u0645\u0644\u064a\u0629\x20\u062c\u0644\u0628\x20\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a\x2e\x2e\x2e','\x2e\x70\x61\x67\x69\x6e\x61\x74\x65\x5f\x62\x75\x74\x74\x6f\x6e\x2e\x6e\x65\x78\x74\x3a\x6e\x6f\x74\x28\x2e\x64\x69\x73\x61\x62\x6c\x65\x64\x29','\x71\x75\x65\x72\x79\x53\x65\x6c\x65\x63\x74\x6f\x72','\x65\x72\x72\x6f\x72','\u0644\u0645\x20\u064a\u062a\u0645\x20\u0627\u0644\u0639\u062b\u0648\u0631\x20\u0639\u0644\u0649\x20\u062c\u062f\u0648\u0644\x20\u0641\u064a\x20\u0627\u0644\u0635\u0641\u062d\u0629\x2e','\x71\x75\x65\x72\x79\x53\x65\x6c\x65\x63\x74\x6f\x72\x41\x6c\x6c','\x74\x72','\x6c\x65\x6e\x67\x74\x68','\x74\x68','\x6d\x61\x70','\x74\x72\x69\x6d','\x69\x6e\x6e\x65\x72\x54\x65\x78\x74','\x70\x75\x73\x68','\x74\x64','\u062a\u0645\x20\u062c\u0644\u0628\x20','\x20\u0633\u062c\u0644\x20\u062d\u062a\u0649\x20\u0627\u0644\u0622\u0646\x2e','\u0644\u0627\x20\u062a\u0648\u062c\u062f\x20\u0628\u064a\u0627\u0646\u0627\u062a\x20\u0644\u062a\u0646\u0632\u064a\u0644\u0647\u0627\x2e','\x22','','\x6a\x6f\x69\x6e','\x2c','\x5c\x6e','\x74\x65\x78\x74\x2f\x63\x73\x76\x3b\x63\x68\x61\x72\x73\x65\x74\x3d\x75\x74\x66\x2d\x38\x3b','\x63\x72\x65\x61\x74\x65\x45\x6c\x65\x6d\x65\x6e\x74','\x61','\x63\x72\x65\x61\x74\x65\x4f\x62\x6a\x65\x63\x74\x55\x52\x4c','\x73\x65\x74\x41\x74\x74\x72\x69\x62\x75\x74\x65','\x68\x72\x65\x66','\x64\x6f\x77\x6e\x6c\x6f\x61\x64','\x73\x74\x75\x64\x65\x6e\x74\x5f\x64\x61\x74\x61\x2e\x63\x73\x76','\x76\x69\x73\x69\x62\x69\x6c\x69\x74\x79','\x68\x69\x64\x64\x65\x6e','\x73\x74\x79\x6c\x65','\x61\x70\x70\x65\x6e\x64\x43\x68\x69\x6c\x64','\u062c\u0627\u0631\u064a\x20\u062a\u0646\u0632\u064a\u0644\x20\u0645\u0644\u0641\x20\u0627\u0644\u0625\u0643\u0633\u064a\u0644\x20\x28\x43\x53\x56\x29\x2e\x2e\x2e','\x63\x6c\x69\x63\x6b','\x72\x65\x6d\x6f\x76\x65\x43\x68\x69\x6c\x64','\x62\x6f\x64\x79','\u0627\u0644\u0627\u0646\u062a\u0642\u0627\u0644\x20\u0625\u0644\u0649\x20\u0627\u0644\u0635\u0641\u062d\u0629\x20\u0627\u0644\u062a\u0627\u0644\u064a\u0629\x2e\x2e\x2e','\u062a\u0645\x20\u0627\u0644\u0648\u0635\u0648\u0644\x20\u0625\u0644\u0649\x20\u0622\u062e\u0631\x20\u0635\u0641\u062d\u0629\x2e','\u0627\u0643\u062a\u0645\u0644\x20\u062c\u0644\u0628\x20\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a\x2e\x20\u0625\u062c\u0645\u0627\u0644\u064a\x20\u0627\u0644\u0633\u062c\u0644\u0627\u062a\x3a\x20'];(async function main(){console[_0x53a9[0]](_0x53a9[1]);const _0x1394bb=_0x53a9[2];let _0x296317=[];function _0x3e1766(){const _0x125b87=document[_0x53a9[3]]('table');if(!_0x125b87){console[_0x53a9[4]](_0x53a9[5]);return;}const _0x56a640=_0x125b87[_0x53a9[6]](_0x53a9[7]);if(_0x296317[_0x53a9[8]]===0){const _0x53341b=Array['from'](_0x56a640[0][_0x53a9[6]](_0x53a9[9]))[_0x53a9[10]](_0x205563=>_0x205563[_0x53a9[12]][_0x53a9[11]]());_0x296317[_0x53a9[13]](_0x53341b);}for(let _0x171801=1;_0x171801<_0x56a640[_0x53a9[8]];_0x171801++){const _0x3b8548=Array['from'](_0x56a640[_0x171801][_0x53a9[6]](_0x53a9[14]))[_0x53a9[10]](_0x39a1f1=>_0x39a1f1[_0x53a9[12]][_0x53a9[11]]());if(_0x3b8548[_0x53a9[8]]>0){_0x296317[_0x53a9[13]](_0x3b8548);}}console[_0x53a9[0]](_0x53a9[15],_0x296317[_0x53a9[8]]-1,_0x53a9[16]);}function _0x1a879e(_0x1b4129){if(_0x1b4129[_0x53a9[8]]<=1){console[_0x53a9[0]](_0x53a9[17]);return;}const _0x1b06c8='\uFEFF';let _0x223788=_0x1b4129[_0x53a9[10]](_0x1116c9=>_0x1116c9[_0x53a9[10]](_0x2d1748=>`"${String(_0x2d1748)['split'](_0x53a9[18])['join'](_0x53a9[19])}"`)[_0x53a9[20]](_0x53a9[21]))[_0x53a9[20]](_0x53a9[22]);const _0x409559=new Blob([_0x1b06c8+_0x223788],{'type':_0x53a9[23]});const _0x140e6c=document[_0x53a9[24]](_0x53a9[25]);const _0x24e0f0=URL[_0x53a9[26]](_0x409559);_0x140e6c[_0x53a9[27]](_0x53a9[28],_0x24e0f0);_0x140e6c[_0x53a9[27]](_0x53a9[29],_0x53a9[30]);_0x140e6c[_0x53a9[33]][_0x53a9[31]]=_0x53a9[32];document[_0x53a9[40]][_0x53a9[34]](_0x140e6c);console[_0x53a9[0]](_0x53a9[35]);_0x140e6c[_0x53a9[36]]();document[_0x53a9[40]][_0x53a9[37]](_0x140e6c);}while(true){_0x3e1766();const _0x1604a8=document[_0x53a9[3]](_0x1394bb);if(_0x1604a8){console[_0x53a9[0]](_0x53a9[38]);_0x1604a8[_0x53a9[36]]();await new Promise(_0x41e126=>setTimeout(_0x41e126,2000));}else{console[_0x53a9[0]](_0x53a9[39]);break;}}console[_0x53a9[0]](_0x53a9[41],_0x296317[_0x53a9[8]]-1);_0x1a879e(_0x296317);})();
                    </textarea>
                </div>
            </section>
        </main>
        
    </div>

    <script>
        function copyCode() {
            const textarea = document.getElementById('scraperCode');
            navigator.clipboard.writeText(textarea.value).then(() => {
                const btn = document.getElementById('copyBtn');
                btn.textContent = 'تم النسخ!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'نسخ الكود';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>

</body>
</html>
